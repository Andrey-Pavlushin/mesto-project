(()=>{"use strict";var e="a49b225c9ff9fb5cb60da697",t={baseUrl:"https://nomoreparties.co/v1/plus-cohort-28",headers:{authorization:"da67faeb-c3b2-41d3-a184-b77566b0c3bf","Content-Type":"application/json"}};function n(e){e.classList.remove("popup_opened"),document.removeEventListener("keydown",o)}function o(e){"Escape"==e.key&&n(document.querySelector(".popup_opened"))}function r(e){e.classList.add("popup_opened"),document.addEventListener("keydown",o)}function c(n,o,c,a,u){var i=o.content.cloneNode(!0),s=i.querySelector(".photo-card__image"),d=i.querySelector(".photo-card__header"),l=i.querySelector(".photo-card__trash"),f=i.querySelector(".photo-card__heart-button"),m=i.querySelector(".photo-card__heart-number");return s.src=n.link,s.alt=n.name,d.textContent=n.name,m.textContent=n.likes.length,n.owner._id===e?l.addEventListener("click",(function(e){var o;(o=n._id,fetch("".concat(t.baseUrl,"/cards/").concat(o),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(){e.target.closest(".photo-card").remove()})).catch((function(e){return console.log(e)}))})):l.style.display="none",s.addEventListener("click",(function(e){return function(e,t,n,o){r(t),n.src=e.target.src,n.alt=e.target.alt,o.textContent=e.target.alt}(e,c,a,u)})),function(t){return t.likes.some((function(t){return t._id===e}))}(n)&&f.classList.add("photo-card__heart-button_active"),f.addEventListener("click",(function(e){return function(e,n,o){e.classList.contains("photo-card__heart-button_active")?(function(e){e.classList.remove("photo-card__heart-button_active")}(e),function(e){fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n),o.textContent=+o.textContent-1):(function(e){e.classList.add("photo-card__heart-button_active")}(e),function(e){fetch("".concat(t.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(n),o.textContent=+o.textContent+1)}(e.target,n._id,m)})),i}document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".popup-image"),o=document.querySelector(".popup-image__url"),a=document.querySelector(".popup-image__text"),u=document.querySelector(".popup-image__close-button"),i=document.querySelector(".popup-profile"),s=document.querySelector(".popup-profile__close-button"),d=document.querySelector(".popup-card"),l=document.querySelector(".popup-card__close-button"),f=document.querySelector(".form-card__save-button"),m=document.querySelector(".profile__avatar"),_=document.querySelector(".popup-avatar"),p=document.querySelector(".popup-avatar__close-button"),v=document.querySelector(".form-avatar__save-button"),h=document.querySelector(".profile__name"),y=document.querySelector(".profile__caption"),b=document.querySelector(".profile__avatar-image"),S=document.querySelector(".profile__edit-button"),q=document.querySelector(".profile__add-button"),L=document.querySelector(".form-profile"),g=document.querySelector(".form-profile__input_info_name"),C=document.querySelector(".form-profile__input_info_caption"),E=document.querySelector(".form-profile__save-button"),k=document.querySelector(".form-avatar"),x=document.querySelector(".form-avatar__input"),j=document.querySelector(".form-avatar__save-button"),P=document.querySelector(".form-card"),U=document.querySelector(".form-card__save-button"),T=document.querySelector(".form-card__input_info_name"),A=document.querySelector(".form-card__input_info_image"),D=document.querySelector(".photo-grid__list"),B=document.querySelector("#card");function O(e,t){h.textContent=e,y.textContent=t}fetch("".concat(t.baseUrl,"/cards"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(t){return t.forEach((function(t){return D.appendChild(c(t,B,e,o,a))}))})).catch((function(e){return console.log(e)})),fetch("".concat(t.baseUrl,"/users/me"),{headers:t.headers}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))})).then((function(e){O(e.name,e.about),b.src=e.avatar})).catch((function(e){return console.log(e)})),s.addEventListener("click",(function(){return n(i)})),u.addEventListener("click",(function(){return n(e)})),l.addEventListener("click",(function(){return n(d)})),p.addEventListener("click",(function(){return n(_)})),S.addEventListener("click",(function(){r(i),g.value=h.textContent,C.value=y.textContent})),q.addEventListener("click",(function(){return r(d)})),m.addEventListener("click",(function(){return r(_)})),L.addEventListener("submit",(function(e){e.preventDefault(),E.textContent="Сохранение...",function(e,n){return fetch("".concat(t.baseUrl,"/users/me"),{method:"PATCH",headers:t.headers,body:JSON.stringify({name:e,about:n})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))}(g.value,C.value).then((function(e){O(e.name,e.about),n(i),E.textContent="Сохранить"})).catch((function(e){return console.log(e)})),e.target.reset()})),P.addEventListener("submit",(function(r){var u,i;r.preventDefault(),f.textContent="Сохранение...",(u=T.value,i=A.value,fetch("".concat(t.baseUrl,"/cards"),{method:"POST",headers:t.headers,body:JSON.stringify({name:u,link:i})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(t){D.insertBefore(c(t,B,e,o,a),D.firstChild),f.textContent="Сохранить",n(d)})).catch((function(e){return console.log(e)})),U.disabled=!0,U.classList.add("form__save-button_disabled"),r.target.reset()})),k.addEventListener("submit",(function(e){var o;e.preventDefault(),v.textContent="Сохранение...",(o=x.value,fetch("".concat(t.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:t.headers,body:JSON.stringify({avatar:o})}).then((function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}))).then((function(e){b.src=e.avatar,v.textContent="Сохранить",n(_)})).catch((function(e){return console.log(e)})),j.disabled=!0,j.classList.add("form__save-button_disabled"),e.target.reset()})),function(e){var t=document.querySelectorAll(e.formSelector);Array.from(t).forEach((function(t){var o=t.querySelectorAll(e.inputSelector),a=t.querySelector(e.submitButtonSelector);t.addEventListener("input",(function(u){!function(e,t,n,o){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?(t.classList.remove(n),c(e,t,o)):(t.classList.add(n),r(e,t,o,t.validationMessage))}(t,u.target,e.inputErrorClass),n(o,a,e.inactiveButtonClass)}))}));var n=function(e,t,n){o(e)?(t.disabled=!0,t.classList.add(n)):(t.disabled=!1,t.classList.remove(n))},o=function(e){return Array.from(e).some((function(e){return!e.validity.valid}))},r=function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));r.textContent=o,r.classList.add(n)},c=function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));o.classList.remove(n),o.textContent=""}}({formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__error_visible"}),[d,e,i,_].forEach((function(e){return e.addEventListener("click",(function(e){e.target===e.currentTarget&&n(e.target)}))}))}))})();